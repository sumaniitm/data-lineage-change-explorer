<!DOCTYPE html>
<html lang="en">
  <meta charset="utf-8">
  <script src="https://d3js.org/d3.v5.js"></script>
  <script src="https://dagrejs.github.io/project/dagre-d3/latest/dagre-d3.js"></script>
  <title>Dagre D3 Demo: Sentence Tokenization</title>
  
  <h1>Dagre D3 Demo: ER Diagram</h1>
  
  <style id="css">
  
  body {
    font: 300 14px 'Helvetica Neue', Helvetica;
  }
  
  .node rect {
    stroke: #333;
    fill: #fff;
  }
  
  .edgePath path {
    stroke: #333;
    fill: #333;
    stroke-width: 1.5px;
  }
  </style>
  
  <svg id="svg-canvas" width=800 height=800></svg>
  
  <section>
  <p>An example of visualizing an ER Diagram</section>
  <script>
    var g = new dagreD3.graphlib.Graph().setGraph({});
    var states = [ "Market Customer Demand", "Customer Demand", "Direct Demand", "Predicted Demand",
                   "Sales Order", "Remaining Forecast", "CModel Outputs" ];;
    // Automatically label each of the nodes
    states.forEach(function(state) { g.setNode(state, { label: state }); });
    
    // Set up the edges
    g.setEdge("Market Customer Demand", "Customer Demand", { label: "1" });
    g.setEdge("Customer Demand", "Direct Demand", { label: "2" });
    g.setEdge("Customer Demand", "Predicted Demand", { label: "3" });
    g.setEdge("Direct Demand", "Sales Order", { label: "4" });
    g.setEdge("Direct Demand", "Remaining Forecast", { label: "5" });
    g.setEdge("Predicted Demand", "Model Outputs", { label: "6" });
    
    // Set some general styles
    g.nodes().forEach(function(v) {
      var node = g.node(v);
      node.rx = node.ry = 5;
    });
    
    // Add some custom colors based on state
    g.node('Market Customer Demand').style = "fill: #f77";
    g.node('Predicted Demand').style = "fill: #7f7";
    
    var svg = d3.select("svg"),
    svgGroup = svg.append("g");
    
    // Set up zoom support
    var zoom = d3.zoom().on("zoom", function() {
          inner.attr("transform", d3.event.transform);
        });
    svg.call(zoom);
    
    // Create the renderer
    var render = new dagreD3.render();
    
    // Run the renderer. This is what draws the final graph.
    render(d3.select("svg g"), g);
    
    // Center the graph
    var initialScale = 0.75;
    svg.call(zoom.transform, d3.zoomIdentity.translate((svg.attr("width") - g.graph().width * initialScale) / 2, 20).scale(initialScale));
    
    svg.attr('height', g.graph().height * initialScale + 40);
  
  </script>
  
  {% block main %}
    {% for i in lineage %}
      <div style="width:250px;height:50px;border:1px solid #000;">
          <h3>{{ i }}</h3>
      </div>
    {% endfor %}
  <ul class="navbar-nav">
    <li class="nav-item"><a href="{{ url_for('index') }}" class="nav-link">Back to main</a></li>
    <li class="nav-item"><a href="{{ url_for('attributeDeltaLineage') }}" class="nav-link">domain object values delta lineage</a></li>
  </ul>
  {% endblock %}
</html>